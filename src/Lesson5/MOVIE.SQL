CREATE TABLE MOVIE(
ID NUMBER,
CONSTRAINT MOVIE_ID PRIMARY KEY (ID),
TITLE NVARCHAR2(50) NOT NULL,
DIRECTOR NVARCHAR2(20) NOT NULL,
YEAR NUMBER CHECK (YEAR BETWEEN 1900 AND 2020),
LENGTH_MINS NUMBER CHECK (LENGTH_MINS BETWEEN 10 AND 200)
);

CREATE TABLE MOVIE_STAT(
MOVIE_ID NUMBER,
CONSTRAINT MOVIE_STAT_ID PRIMARY KEY (MOVIE_ID),
RATING NUMBER(2,1),
DOMESTIC_SALES NUMBER,
INTERNATIONAL_SALES NUMBER
);

SELECT DIRECTOR, COUNT(ID) FROM MOVIE
GROUP BY DIRECTOR;

SELECT DIRECTOR, SUM(DOMESTIC_SALES), SUM(INTERNATIONAL_SALES) FROM MOVIE, MOVIE_STAT
WHERE MOVIE.ID = MOVIE_STAT.ID
GROUP BY DIRECTOR;

SELECT * FROM MOVIE
ORDER BY YEAR DESC;

SELECT * FROM MOVIE_STAT
GROUP BY INTERNATIONAL_SALES ASC;